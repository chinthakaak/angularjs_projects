<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>AGM</title>
    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.js"></script>
    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">
   <link href="css/style.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="css/style.css" rel="stylesheet">

    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>


	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
	<title>AGM Conversation Application</title>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
	<script src="js/mqttws31.min.js"></script>
	<script src="js/app-config.js"></script>
	<script src="js/app-mqtt-provider.js"></script>
</head>
<body ng-app = "convApp">
	<nav class="navbar navbar-default">
        <div class="container-fluid">
            <a href="#"><img src="img/logo.png" />IOT-AGM</a>
        </div>
    </nav>
    
	<!-- View -->
	<div id="DisplayControllerId" ng-controller="DisplayController">
		<div ng-repeat="dialog in dialogs">			
	        <div class="container">
	           <div class="row">
	            <div ng-if="dialog.user == 'patient'" class="col-xs-12">
	                <div class="col-md-4"><img src="img/user.png" alt="user" /></div>
	                <div class="col-md-8">
	                    <div class="col-xs-6">
	                        <p class="user">{{dialog.message}}</p>
	                    </div>
	                         <div class="col-xs-6">
	                        <p class="datetime"><span>{{dialog.timestamp|date:'EEEE'}}</span>|<span>
	                        						  {{dialog.timestamp|date:'MM'}}th {{dialog.timestamp|date:'MMMM'}}</span>|<span>
	                        						  {{dialog.timestamp|date:'shortTime'}}</span></p>
	                    </div>  
	                </div>
	            </div><!--/.User -->
	            <div ng-if="dialog.user == 'doctor'" class="col-xs-12">
	                <div class="col-md-4"></div>
	                <div class="col-md-4 doctoricon"><img src="img/doctor.png" alt="user" /></div>
	                <div class="col-md-8 rowcolor">
	                    <div class="col-xs-6 ">
	                        <p class="user">{{dialog.message}}</p>
	                    </div>
	                         <div class="col-xs-6">
	                        <p class="datetime"><span>{{dialog.timestamp|date:'EEEE'}}</span>|<span>
	                        						  {{dialog.timestamp|date:'MM'}}th {{dialog.timestamp|date:'MMMM'}}</span>|<span>
	                        						  {{dialog.timestamp|date:'shortTime'}}</span></p>
	                    </div>  
	                </div>
	            </div><!--/.doctor -->
		</div>
	</div>
	
	<script type="text/javascript">
		connect_mqtt()
		angular.module("convApp", [])
		
		// Controller
		.controller("DisplayController", ['$scope',function($scope) {			
			// Model
			$scope.dialogs = []
			$scope.addDialog = function(msg) {				
				$scope.dialogs.push(msg.d)
			}
		}]);
	</script>
</body>
</html>